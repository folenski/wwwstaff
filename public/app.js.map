{
  "version": 3,
  "sources": ["../app/src/modules/Contact.ts", "../node_modules/fski-reveal/dist/Reveal.js", "../app/src/app.ts"],
  "sourcesContent": ["/**\n * Class pour g\u00E9rer un contact\n *\n * 06/01/2022 - Version initiale\n * 12/01/2022 - La recuperation des champs est maintenant dynamique et gestion de la direction\n *              de la div de retour\n * 13/07/2022 - \u00E9criture en TS\n */\n\ninterface ContactParam {\n  idform: string;\n  url?: string;\n  errorMsg?: string;\n  overlay?: {\n    from: string;\n    class: string[];\n  };\n  btn?: {\n    lib: string;\n    class: string[];\n  };\n}\n\nclass Contact {\n  private _element!: HTMLFormElement;\n  private _Param!: ContactParam;\n\n  private _ParamDefault: ContactParam = {\n    idform: \"none\",\n    url: \"/api/msg\",\n    errorMsg: \"An error was encountered<br/>Please try again later\",\n    overlay: { from: \"bottom\", class: [\"form-overlay\"] },\n    btn: { lib: \"Ok\", class: [\"btn\"] },\n  };\n\n  private _overlay!: HTMLDivElement;\n  private _overlayContent!: HTMLDivElement;\n  private _overlayTxt!: HTMLSpanElement;\n  private _transition = false;\n\n  constructor(element: HTMLFormElement, Param: ContactParam) {\n    this._element = element;\n    this._Param = { ...this._ParamDefault, ...Param };\n\n    this.createOverlay();\n    this.initOverlay();\n\n    this._overlay.addEventListener(\"transitionend\", this.transitionendOverlay);\n    this._element.addEventListener(\"submit\", this.submitForm);\n  }\n\n  /**\n   * Cr\u00E9ation de l'overlay pour le retour du fetch\n   */\n  createOverlay() {\n    this._overlay = document.createElement(\"div\");\n    this._overlay.style.display = \"none\";\n    this._overlay.style.opacity = \"0\";\n\n    const parent = this._element.parentElement;\n    if (parent) parent.appendChild(this._overlay);\n\n    // on ajoute les classes\n    if (this._Param.overlay)\n      this._Param.overlay.class.forEach((cl) =>\n        this._overlay.classList.add(cl)\n      );\n\n    this._overlayContent = document.createElement(\"div\");\n    this._overlay.appendChild(this._overlayContent);\n\n    this._overlayTxt = document.createElement(\"span\");\n    this._overlayContent.appendChild(this._overlayTxt);\n    this._overlayContent.appendChild(document.createElement(\"br\"));\n\n    // Gestion du bouton retour\n    if (this._Param.btn) {\n      const btnBack = document.createElement(\"button\");\n      btnBack.innerHTML = this._Param.btn.lib;\n      this._Param.btn.class.forEach((cl) => btnBack.classList.add(cl));\n      btnBack.addEventListener(\"click\", this.handleBack);\n      this._overlayContent.appendChild(btnBack);\n    }\n  }\n\n  initOverlay() {\n    if (!this._Param.overlay) return;\n\n    this._overlayContent.style.opacity = \"0\";\n    this._transition = true;\n\n    switch (this._Param.overlay.from) {\n      case \"top\":\n        this._overlay.style.height = \"0\";\n        this._overlay.style.width = \"100%\";\n        this._overlay.style.top = \"0\";\n        break;\n\n      case \"right\":\n        this._overlay.style.height = \"100%\";\n        this._overlay.style.width = \"0\";\n        this._overlay.style.top = \"0\";\n        this._overlay.style.right = \"0\";\n        break;\n\n      case \"left\":\n        this._overlay.style.height = \"100%\";\n        this._overlay.style.width = \"0\";\n        this._overlay.style.top = \"0\";\n        this._overlay.style.left = \"0\";\n        break;\n\n      default:\n        // bottom\n        this._overlay.style.height = \"0\";\n        this._overlay.style.width = \"100%\";\n        this._overlay.style.bottom = \"0\";\n        break;\n    }\n  }\n\n  openOverlay() {\n    if (!this._Param.overlay) return;\n\n    this._overlay.style.opacity = \"1\";\n    this._overlayContent.style.opacity = \"1\";\n\n    //    this._transition = true;\n    switch (this._Param.overlay.from) {\n      case \"top\":\n        this._overlay.style.height = \"100%\";\n        break;\n      case \"right\":\n      case \"left\":\n        this._overlay.style.width = \"100%\";\n        break;\n      default:\n        // bottom\n        this._overlay.style.height = \"100%\";\n        break;\n    }\n  }\n\n  submitForm = async (evt: Event) => {\n    evt.preventDefault();\n    if (!this._Param.url) return;\n    let dataForm = {};\n    Array.from(this._element).forEach((el) => {\n      if (\n        !(el instanceof HTMLTextAreaElement || el instanceof HTMLInputElement)\n      )\n        return;\n\n      switch (el.name) {\n        case \"nom\":\n          dataForm = { ...dataForm, nom: el.value };\n          break;\n        case \"tel\":\n          dataForm = { ...dataForm, tel: el.value };\n          break;\n        case \"mail\":\n          dataForm = { ...dataForm, mail: el.value };\n          break;\n        case \"sujet\":\n          dataForm = { ...dataForm, sujet: el.value };\n          break;\n        case \"message\":\n          dataForm = { ...dataForm, message: el.value };\n          break;\n        default:\n          break;\n      }\n    });\n\n    let msg = this._Param.errorMsg;\n    this._overlay.style.display = \"block\";\n\n    const response = await fetch(this._Param.url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json;charset=utf-8\",\n      },\n      body: JSON.stringify(dataForm),\n    });\n\n    if (response.ok) {\n      const result = await response.json();\n      msg = result.msg;\n    } else {\n      console.error(\"Contact: Error response -  \", response);\n    }\n\n    if (msg) {\n      this._overlayTxt.innerHTML = msg;\n      this.openOverlay();\n    }\n  };\n\n  transitionendOverlay = () => {\n    if (!this._transition) return;\n    this._transition = false;\n\n    if (this._overlayContent.style.opacity === \"0\") {\n      this._overlay.style.opacity = \"0\";\n    }\n  }\n\n  handleBack = (evt: Event) => {\n    evt.preventDefault();\n    this._element.reset();\n    this.initOverlay();\n    //this._overlay.style.height = \"0\";\n    this._overlay.addEventListener(\"transitionend\", this.handleBackEnd);\n  };\n\n  handleBackEnd = () => {\n    this._overlay.style.display = \"none\";\n    this._overlay.removeEventListener(\"transitionend\", this.handleBackEnd);\n  };\n\n  static async bind(param: ContactParam) {\n    const el = document.getElementById(param.idform);\n    if (el instanceof HTMLFormElement) {\n      return new Contact(el, param);\n    }\n  }\n}\n\nexport default Contact;\n", "/**\n * Class Reveal permet de gerer les animations de site\n *\n *  24/11/2021 - re ecriture en typescript\n *  29/11/2021 - ajout d'un timer pour retarder les animations\n *  12/12/2021 - Am\u00E9lioration des animations\n */\n/**\n * @property {HTMLElement} element\n * @property {{y: number, variable: boolean}} options\n */\nexport class Reveal {\n    constructor(element, param) {\n        this.timerLoad = 100; // en milliseconde\n        this.threshold = 0.3;\n        this.tpsAnim = \"1.3s\";\n        this.tpsAnimDisplay = \"3s\";\n        this.infinite = false;\n        this.decalage = 3;\n        this.reveal = \"\";\n        /**\n         * permet de gerer l'initialisation des \u00E9l\u00E9ments reveal\n         * @param transition  si vrai alors on ajoute les transactions\n         * @returns\n         */\n        this.doInit = (transition = false) => {\n            if (!this.element)\n                return;\n            if (!transition) {\n                // on initialise les elements\n                this.element.style.opacity = \"0\";\n                this.element.style.visibility = \"hidden\";\n                switch (this.reveal) {\n                    case \"top\":\n                        this.element.style.transform = `translate(0, ${-1 * this.decalage}rem)`;\n                        break;\n                    case \"left\":\n                        this.element.style.transform = `translate(${-1 * this.decalage}rem)`;\n                        break;\n                    case \"right\":\n                        this.element.style.transform = `translate(${this.decalage}rem)`;\n                        break;\n                    default:\n                        break;\n                }\n            }\n            else {\n                if (this.reveal == \"display\")\n                    this.element.style.transition = `opacity ${this.tpsAnimDisplay} ease-out `;\n                else\n                    this.element.style.transition = this.tpsAnim;\n            }\n        };\n        this.doReveal = () => {\n            if (!this.element)\n                return;\n            if (!this.isVisible)\n                return;\n            this.element.style.visibility = \"inherit\";\n            this.element.style.opacity = \"\";\n            if (this.reveal != \"display\")\n                this.element.style.transform = \"\";\n        };\n        this.onResize = () => {\n            this.doInit();\n        };\n        this.element = element;\n        if (this.element.dataset.reveal)\n            this.reveal = this.element.dataset.reveal;\n        this.threshold = (param === null || param === void 0 ? void 0 : param.threshold) ? param.threshold : this.threshold;\n        this.infinite = (param === null || param === void 0 ? void 0 : param.infinite) ? param.infinite : this.infinite;\n        this.tpsAnimDisplay = (param === null || param === void 0 ? void 0 : param.tpsAnimDisplay)\n            ? param.tpsAnimDisplay\n            : this.tpsAnimDisplay;\n        this.tpsAnim = (param === null || param === void 0 ? void 0 : param.tpsAnim) ? param.tpsAnim : this.tpsAnim;\n        this.timerLoad = (param === null || param === void 0 ? void 0 : param.timerLoad) ? param.timerLoad : this.timerLoad;\n        const observer = new IntersectionObserver((entries) => {\n            for (const entry of entries) {\n                if (entry.isIntersecting) {\n                    document.addEventListener(\"resize\", this.onResize);\n                    this.isVisible = true;\n                    window.requestAnimationFrame(() => {\n                        this.doReveal();\n                    });\n                }\n                else {\n                    this.isVisible = false;\n                    if (this.infinite)\n                        this.doInit();\n                    window.removeEventListener(\"resize\", this.onResize);\n                }\n            }\n        }, {\n            threshold: this.threshold\n        });\n        this.doInit();\n        window.addEventListener(\"load\", () => {\n            if (!this.element)\n                return;\n            const el = this.element;\n            this.doInit(true);\n            setTimeout(() => observer.observe(el), this.timerLoad);\n        });\n    }\n    static async bind(param = {}) {\n        return Array.from(document.querySelectorAll(\"[data-reveal]\")).map((element) => {\n            if (element instanceof HTMLElement)\n                return new Reveal(element, param);\n        });\n    }\n}\n", "/**\n * Script pour l'application de test\n *\n * 09/01/2022 - Version initiale\n * 13/14/2022 - Utilisaation de TypeScript\n */\n\nimport \"./modules/Contact\";\nimport { Reveal } from \"fski-reveal\";\nimport Contact from \"./modules/Contact\";\n\nReveal.bind({ infinite: true }); // Reveal\n\nContact.bind( {\n    idform: \"contactForm\", \n    btn: {lib: \"Ok\", class: [\"btn\", \"secondary\"]},\n    overlay: {from: \"right\", class: [\"form-overlay\", \"primary\"]}\n})"],
  "mappings": "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",
  "names": ["Contact", "element", "Param", "evt", "__async", "dataForm", "el", "__spreadProps", "__spreadValues", "msg", "response", "parent", "cl", "btnBack", "param", "Contact_default", "Reveal", "element", "param", "transition", "observer", "entries", "entry", "el", "__async", "Reveal", "Contact_default"]
}
